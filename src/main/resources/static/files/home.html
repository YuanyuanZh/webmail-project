
<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>Web Mail</title>
    <meta content='width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no' name='viewport'>
    <!-- bootstrap 3.0.2 -->
    <link href="/resources/css/bootstrap.min.css" rel="stylesheet" type="text/css" />
    <!--  -->
    <link href="/resources/css/bootstrap.progress-auto.css" rel="stylesheet" type="text/css" />
    <!-- font Awesome -->
    <link href="/resources/css/font-awesome.min.css" rel="stylesheet" type="text/css" />
    <!-- Ionicons -->
    <!--<link href="/resources/css/ionicons.min.css" rel="stylesheet" type="text/css" />-->
    <!-- bootstrap wysihtml5 - text editor -->
    <!--<link href="/resources/css/bootstrap-wysihtml5/bootstrap3-wysihtml5.min.css" rel="stylesheet" type="text/css" />-->
    <!-- iCheck for checkboxes and radio inputs -->
    <!--<link href="/resources/css/iCheck/minimal/blue.css" rel="stylesheet" type="text/css" />-->
    <!-- Theme style -->
    <link href="/resources/css/mail.css" rel="stylesheet" type="text/css" />

    <!-- favicon from https://dribbble.com/shots/1297277-Adline-Social-icons-Retouched?list=searches&tag=mail_icon&offset=11 -->
    <link rel="shortcut icon" href="/resources/img/favicon.ico" type="image/x-icon">
    <link rel="icon" href="/resources/img/favicon.ico" type="image/x-icon">

    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
    <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
    <![endif]-->
</head>
<body class="">


<div class="wrapper">
<aside class="left-side x-col">
    <div class="column-header">
    </div>

    <div style="padding: 1em;">
        <button class="btn btn-primary btn-block compose-btn btn-disabled" disabled="disabled"><i class="fa fa-pencil-square-o"></i>&nbsp;&nbsp; Compose</button>
    </div>

    <div style="padding: 0;">
        <ul is="mainMenu" class="nav nav-stacked mail-menu">
            <li id="folderInbox" class="active"><a href="#"><i class="fa fa-inbox"></i> <span>Inbox</span>
                <!--<small class="badge pull-right bg-green">192</small>-->
            </a></li>
            <!--<li><a href="#"><i class="fa fa-archive"></i> <span>Sent</span></a></li>-->
            <!--<li><a href="#"><i class="fa fa-star-o"></i> <span>Favorites</span></a></li>-->
            <!--<li><a href="#"><i class="fa fa-file-o"></i> <span>Drafts</span></a></li>-->
            <!--<li><a href="#"><i class="fa fa-trash"></i> <span>Trash</span></a></li>-->
        </ul>

        <!-- <h5 class="h5">TAGS</h5> -->
    </div>

    <div id="tbSystem" class="toolbar toolbar-bottom">
        <div class="btn-group" style="margin-left: 56px;">
            <button class="btn btn-default logout-btn"><i class="fa fa-power-off"></i></button>
            <button class="btn btn-default settings-btn"><i class="fa fa-cog"></i></button>
        </div>
    </div>

</aside>

<!-- Mail list -->
<aside id="maillist" class="second-left-side x-col">

    <div class="column-header">
        <!--<div class="search-box pull-right">-->
            <!--<input class="" placeholder="Search Mail..." type="text" />-->
            <!--<span class="search-icon"><i class="fa fa-search"></i></span>-->
        <!--</div>-->

        <h2 class="folder-name">Inbox</h2>
    </div>

    <header class="toolbar">
        <div class="btn-group">
            <!-- <button class="btn btn-default"><i class="fa fa-refresh"></i></button> -->
            <button class="btn btn-default refresh-btn"><i class="fa fa-refresh"></i></button>
        </div>
        <div class="btn-group">
            <!--<button type="button" class="btn btn-default"><i class="fa fa-archive"></i></button>-->
            <!--<button type="button" class="btn btn-default"><i class="fa fa-info-circle"></i></button>-->
            <button type="button" class="btn btn-default"><i class="fa fa-trash"></i></button>
        </div>

        <!--<div class="btn-group">-->
            <!--<button type="button" class="btn btn-default" title="Move to"><i class="fa fa-folder"></i></button>-->
            <!--<button type="button" class="btn btn-default" title="Tag"><i class="fa fa-tag"></i></button>-->
        <!--</div>-->

        <div class="pull-right" style="display:inline-block; margin-left: 15px; vertical-align: top; text-align: center;">
            <small>1-100 of 1024</small>
            <br/>
            <i class="fa fa-chevron-left"></i>&nbsp;&nbsp;&nbsp;
            <i class="fa fa-chevron-right"></i>

            <!-- <div class="btn-group">
              <button type="button" class="btn btn-default"><i class="fa fa-chevron-left"></i></button>
              <button type="button" class="btn btn-default"><i class="fa fa-chevron-right"></i></button>
            </div> -->

        </div>
    </header>

    <div id="maillistWrapper" data-layout="fill-parent" style="height: 600px; overflow-y:auto; overflow-x: hidden; padding: 0 20px 20px;">
        <!-- <div class="toolbar-placeholder"></div> -->

        <div id="mailListState" class="hidden alert alert-info" role="alert">
            Oops! No mail found. Try to sync it.
        </div>

        <dl class="mail-list">

            <!--<dd class="mail-list-item unread">-->
                <!--<div class="action-controls">-->
                    <!--<input type="checkbox" />-->
                    <!--<div style="margin-top:8px;">-->
                        <!--<i class="fa fa-star-o"></i>-->
                    <!--</div>-->
                <!--</div>-->
                <!--<div class="writer">-->
                    <!--<strong>Facebook</strong>-->
                    <!--<span class="pull-right">3:04 (1小时前)</span>-->
                <!--</div>-->
                <!--<h4>Do you know Tony Townsend, Boyu Wang and 8 others?</h4>-->
            <!--</dd>-->


            <!--<dd class="mail-list-item unread">-->
                <!--<div class="action-controls">-->
                    <!--<input type="checkbox" />-->
                    <!--<div style="margin-top:8px;">-->
                        <!--<i class="fa fa-star-o"></i>-->
                    <!--</div>-->
                <!--</div>-->
                <!--<div class="writer">-->
                    <!--<strong>Pinterest</strong>-->
                    <!--<span class="pull-right">September 21</span>-->
                <!--</div>-->
                <!--<h4>Another thing you can do on Pinterest: Renovate your home!</h4>-->
                <!--<p>Did you know you can also use Pinterest to plan out any improvements-->
                    <!--you want to make to your home? So if you’re redecorating your living-->
                    <!--room, just do a quick search to see what rugs,-->
                    <!--couches and other great ideas people have discovered. </p>-->
            <!--</dd>-->


            <!--<dd class="mail-list-item active">-->
                <!--<div class="action-controls">-->
                    <!--<input type="checkbox" />-->
                    <!--<div style="margin-top:8px;">-->
                        <!--<i class="fa fa-star-o"></i>-->
                    <!--</div>-->
                <!--</div>-->
                <!--<div class="writer">-->
                    <!--<strong>OpenShift by Red Hat</strong>-->
                    <!--<span class="pull-right">21:39 (4小时前)</span>-->
                <!--</div>-->
                <!--<h4>Announcing Dedicated Node Services</h4>-->
                <!--<p>-->
                    <!--Last week we announced Dedicated Node Services for OpenShift.-->
                    <!--Dedicated Node gives Enterprise users more options and power than ever,-->
                    <!--providing customized and dedicated-->
                <!--</p>-->
            <!--</dd>-->

            <!--<dd class="mail-list-item">-->
                <!--<div class="action-controls">-->
                    <!--<input type="checkbox" />-->
                    <!--<div style="margin-top:8px;">-->
                        <!--<i class="fa fa-star-o"></i>-->
                    <!--</div>-->
                <!--</div>-->
                <!--<div class="writer">-->
                    <!--<strong>OpenShift by Red Hat</strong>-->
                      <!--<span class="pull-right">-->
                        <!--<i class="fa fa-paperclip"></i>-->
                         <!--21:39 (4小时前)</span>-->
                <!--</div>-->
                <!--<h4>Work Inquire from Apple</h4>-->
                <!--<p>-->
                    <!--Last week we announced Dedicated Node Services for OpenShift.-->
                    <!--Dedicated Node gives Enterprise users more options and power than ever,-->
                    <!--providing customized and dedicated nodes to-->
                <!--</p>-->
            <!--</dd>-->

            <!--<dd class="mail-list-item">-->
                <!--<div class="action-controls">-->
                    <!--<input type="checkbox" />-->
                    <!--<div style="margin-top:8px;">-->
                        <!--<i class="fa fa-star-o"></i>-->
                    <!--</div>-->
                <!--</div>-->
                <!--<div class="writer">-->
                    <!--<strong>OpenShift by Red Hat</strong>-->
                    <!--<span class="pull-right">21:39 (4小时前)</span>-->
                <!--</div>-->
                <!--<h4>Work Inquire from Apple</h4>-->
                <!--<p>-->
                    <!--Last week we announced Dedicated Node Services for OpenShift.-->
                    <!--Dedicated Node gives Enterprise users more options and power than ever,-->
                    <!--providing customized and dedicated nodes to-->
                <!--</p>-->
            <!--</dd>-->

            <!--<dd class="mail-list-item">-->
                <!--<div class="action-controls">-->
                    <!--<input type="checkbox" />-->
                    <!--<div style="margin-top:8px;">-->
                        <!--<i class="fa fa-star-o"></i>-->
                    <!--</div>-->
                <!--</div>-->
                <!--<div class="writer">-->
                    <!--<strong>OpenShift by Red Hat</strong>-->
                    <!--<span class="pull-right">21:39 (4小时前)</span>-->
                <!--</div>-->
                <!--<h4>Work Inquire from Apple</h4>-->
                <!--<p>-->
                    <!--Last week we announced Dedicated Node Services for OpenShift.-->
                    <!--Dedicated Node gives Enterprise users more options and power than ever,-->
                    <!--providing customized and dedicated nodes to-->
                <!--</p>-->
            <!--</dd>-->

            <!--<dd class="mail-list-item">-->
                <!--<div class="action-controls">-->
                    <!--<input type="checkbox" />-->
                    <!--<div style="margin-top:8px;">-->
                        <!--<i class="fa fa-star-o"></i>-->
                    <!--</div>-->
                <!--</div>-->
                <!--<div class="writer">-->
                    <!--<strong>OpenShift by Red Hat</strong>-->
                    <!--<span class="pull-right">21:39 (4小时前)</span>-->
                <!--</div>-->
                <!--<h4>Work Inquire from Apple</h4>-->
                <!--<p>-->
                    <!--Last week we announced Dedicated Node Services for OpenShift.-->
                    <!--Dedicated Node gives Enterprise users more options and power than ever,-->
                    <!--providing customized and dedicated nodes to-->
                <!--</p>-->
            <!--</dd>-->

            <!--<dd class="mail-list-item">-->
                <!--<div class="action-controls">-->
                    <!--<input type="checkbox" />-->
                    <!--<div style="margin-top:8px;">-->
                        <!--<i class="fa fa-star-o"></i>-->
                    <!--</div>-->
                <!--</div>-->
                <!--<div class="writer">-->
                    <!--<strong>OpenShift by Red Hat</strong>-->
                    <!--<span class="pull-right">21:39 (4小时前)</span>-->
                <!--</div>-->
                <!--<h4>Announcing Dedicated Node Services</h4>-->
                <!--<p>-->
                    <!--Last week we announced Dedicated Node Services for OpenShift.-->
                    <!--Dedicated Node gives Enterprise users more options and power than ever,-->
                    <!--providing customized and dedicated nodes to-->
                <!--</p>-->
            <!--</dd>-->
        </dl>

        <div>
            <div class="btn-group" style="margin: 0 auto;">
                <button type="button" class="btn btn-default btn-sm"><i class="fa fa-chevron-left"></i></button>
                <button type="button" class="btn btn-default btn-sm"><i class="fa fa-chevron-right"></i></button>
            </div>
            1-100 of 1024
        </div>

    </div>

</aside>

<!-- Mail content -->
<aside class="right-side x-col hidden">

    <div class="column-header">
        <div class="pull-right">
            <div class="btn-group">
                <button type="button" class="btn btn-default btn-sm"><i class="fa fa-chevron-left"></i></button>
                <button type="button" class="btn btn-default btn-sm"><i class="fa fa-chevron-right"></i></button>
            </div>
        </div>
        <h2 class="mail-title">Announcing Dedicated Node Services</h2>
    </div>

    <header class="toolbar">
        <div class="btn-group">
            <button type="button" class="btn btn-default"><i class="fa fa-archive"></i></button>
            <button type="button" class="btn btn-default"><i class="fa fa-info-circle"></i></button>
            <button type="button" class="btn btn-default"><i class="fa fa-trash"></i></button>
        </div>

        <div class="btn-group">
            <button type="button" class="btn btn-default"><i class="fa fa-folder"></i></button>
            <button type="button" class="btn btn-default"><i class="fa fa-tag"></i></button>
        </div>

    </header>

    <div id="mailViewport" data-layout="fill-parent" style="height: 600px; overflow-y:auto; padding-bottom: 80px;">

        <article class="mail-entry">
            <div class="mail-info">
                <div class="pull-right">
                    <strong>21:39 (6小时前)</strong>
                </div>
                <h3>OpenShift by Red Hat</h3>
                <p><span>openshift-email@redhat.com</span> to me</p>
            </div>

            <hr/>

            <div class="mail-body">

                <p>Hello,</p>
                <p>Last week we announced Dedicated Node Services for OpenShift. </p>

                <p>
                    Dedicated Node gives Enterprise users more options and power than ever, providing customized and dedicated nodes to host your applications.  Best of all, it's all managed by Red Hat.
                </p>
                <p>
                    Key benefits include:

                <ol>
                    <li>Isolated gears in customizable sizes</li>
                    <li>Global availability--any hosting region AWS EC2 supports</li>
                    <li>VPC between your data center and dedicated node</li>
                    <li>Professional monitoring</li>
                    <li>Award-winning Red Hat support</li><li>Learn more and get your subscription under way by clicking here.</li>
                </ol>

                <p>and,</p>
                <blockquote>
                    <p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Integer posuere erat a ante.</p>
                </blockquote>
            </div><!-- end .mail-body -->

            <hr/>
            <div class="mail-attachments">
                <h5><i class="fa fa-paperclip"></i> Attachments <small>(3 files, 680kb)</small></h5>
                <div class="list-group">
                    <a href="#" class="list-group-item"><i class="fa fa-file-o"></i> force.gif <small>(128kb)</small></a>
                    <a href="#" class="list-group-item"><i class="fa fa-file-o"></i> lighsaber.png</a>
                    <a href="#" class="list-group-item"><i class="fa fa-file-o"></i> hax.html</a>
                </div>
            </div>

        </article>

        <hr/>
        <div class="mail-reply">
            <textarea cols="100" rows="5" placeholder="Click to Reply or Forward"></textarea>
        </div>

    </div>
</aside>
</div>

<div id="dlgProgress" class="modal fade bs-example-modal-sm" tabindex="-1" role="dialog"
     aria-labelledby="mySmallModalLabel" aria-hidden="true" data-backdrop="static" data-keyboard="false">
    <div class="modal-dialog modal-md">
        <div class="modal-content">
            <div class="modal-header">
                <!-- <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span>
          <span class="sr-only">Close</span></button> -->
                <h4 class="modal-title" id="myModalLabel">Loading</h4>
            </div>
            <div class="modal-body">
                <div class="progress auto-progress">
                    <div class="progress-bar progress-bar-success progress-bar-striped active"
                         role="progressbar" aria-valuenow="40" aria-valuemin="0" aria-valuemax="100" style="width: 100%">
                        <span class="sr-only">100% Complete (success)</span>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-default" data-dismiss="modal">Cancel</button>
                <!-- <button type="button" class="btn btn-primary">Save changes</button> -->
            </div>
        </div>
    </div>
</div>


<div id="dlgSetting" class="modal fade bs-example-modal-md" tabindex="-1" role="dialog"
     aria-labelledby="mySmallModalLabel" aria-hidden="true" data-backdrop="static" data-keyboard="false">
    <div class="modal-dialog modal-md">
        <div class="modal-content">
            <div class="modal-header">
                <!-- <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span>
          <span class="sr-only">Close</span></button> -->
                <h4 class="modal-title">Settings</h4>
            </div>
            <div class="modal-body">

                <form class="form-horizontal" role="form">
                    <div class="form-group">
                        <label for="txtPopServer" class="col-sm-4 control-label">Incoming Mail Server</label>
                        <div class="col-sm-8">
                            <input type="email" class="form-control" id="txtPopServer" placeholder="pop.yourmailserver.com">
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="txtEmail" class="col-sm-4 control-label">Email Address</label>
                        <div class="col-sm-8">
                            <input type="email" class="form-control" id="txtEmail" placeholder="john@foobar.com">
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="txtUsername" class="col-sm-4 control-label">User Name</label>
                        <div class="col-sm-8">
                            <input type="email" class="form-control" id="txtUsername" placeholder="John">
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="inputPassword3" class="col-sm-4 control-label">Password</label>
                        <div class="col-sm-8">
                            <input type="password" class="form-control" id="inputPassword3" placeholder="Password">
                        </div>
                    </div>
                    <div class="form-group">
                        <div class="col-sm-offset-4 col-sm-8">
                            <div class="checkbox">
                            <label>
                                <input id="chkSSL" type="checkbox"> Use SSL
                            </label>
                            </div>
                        </div>
                    </div>
                    <!--<div class="form-group">-->
                        <!--<div class="col-sm-offset-3 col-sm-9">-->
                            <!--<div class="checkbox">-->
                                <!--<label>-->
                                    <!--<input type="checkbox"> Remember me-->
                                <!--</label>-->
                            <!--</div>-->
                        <!--</div>-->
                    <!--</div>-->
                    <!--<div class="form-group">-->
                        <!--<div class="col-sm-offset-3 col-sm-9">-->
                            <!--<button type="submit" class="btn btn-default">Sign in</button>-->
                        <!--</div>-->
                    <!--</div>-->

                </form>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-default" data-dismiss="modal">Cancel</button>
                <button type="button" class="btn btn-primary">Save</button>
            </div>
        </div>
    </div>
</div>


<script id="mailSummary" type="text/template">
    <% for (var i = 0; i < items.length; i++) { var item = items[i]; %>
    <dd data-messageIndex="" class="mail-list-item <% if (item.flagUnread) { %>unread<%}%>">
        <div class="action-controls">
            <input type="checkbox" />
            <div style="margin-top:8px;">
                <i class="fa fa-star-o"></i>
            </div>
        </div>
        <div class="writer">
            <strong><%= item.from %></strong>
            <span class="pull-right"><%=item.date%></span>
        </div>
        <h4><%= item.subject %></h4>
        <p>
        </p>
    </dd>
    <%}%>
</script>

<script src="/resources/js/jquery-2.1.1.js"></script>
<script src="/resources/js/bootstrap.js"></script>
<script src="/resources/js/underscore-min.js"></script>
<script src="/resources/js/backbone-min.js"></script>
<script src="/resources/js/notify.min.js"></script>

<script>

    // http://notifyjs.com/
    var Noty = {
        error : function(msg) {
            $.notify(msg, "error")
        },
        info: function(msg) {
            $.notify(msg, "info")
        },
        success: function(msg) {
            $.notify(msg, "success")
        }
    };

    function adjustColumnsHeight() {
        var col_h = $('.left-side').height();

        var calc_offset = function() {
            var tb = $('.toolbar', this);
            var offset = tb.outerHeight() + tb.offset().top;
            return offset;
        }

        $('.x-col:has([data-layout])').each(function(i, n){
            var offset = calc_offset.call(this);
            var _h = col_h - offset;
            $(this).find('[data-layout=fill-parent]').css({"height": _h});
        })
    }

    function setMailListState(haveMail) {
        var state = $('#mailListState');

        if (haveMail) {
            state.addClass('hidden');
        } else {
            state.removeClass('hidden');
//            setTimeout(function(){
//                state.addClass("hidden");
//            }, 1000);
        }
    }

    function loadMailList(firstLoad) {
        var firstLoad = firstLoad || false;

        // http://127.0.0.1:8080/inbox
        var ajax = $.getJSON("/inbox", function(data){
            if (data && data.messages && data.messages.length) {
                var t = _.template($('#mailSummary').html());

                var html = t({items: data.messages});

                $('#maillist .mail-list').empty().append(html);

                setMailListState(true);
            }
            if (firstLoad && data && !data.total) {
                setMailListState(false);
            }
        }).fail(function(xhr) {
            if (xhr.statusText === 'abort') {
                return; // just ignore
            }
            Noty.error("Load mail failed, please try it later.")
        }).always(function() {
        });
    }

    function syncMails() {
        var progressDialog = $('#dlgProgress').modal();

        var ajax = $.getJSON("/rest/mail/sync", function(data){
            if (data && data.state === 'ok') {
                if (data.update) {
                    loadMailList();
                } else {
                    Noty.info("No new messages received");
                }
            } else {
                Noty.error("Sync mail failed, please try it later.")
            }
        }).fail(function(xhr) {
            if (xhr.statusText === 'abort') {
                return; // just ignore
            }
            Noty.error("Sync mail failed, please try it later.")
        }).always(function() {
            progressDialog.modal('hide');
            progressDialog.off('hidden.bs.modal');
        });

        progressDialog.on('hidden.bs.modal', function() {
            ajax.abort();
        })
    }

    $(window).resize(function(){
        adjustColumnsHeight();
    });

    $(function(){
        adjustColumnsHeight();

        loadMailList(true);

        $('#maillist').on('click', '.refresh-btn', syncMails);

        $('#tbSystem').on('click', '.settings-btn', function() {
            $('#dlgSetting').modal();
        }).on('click', '.logout-btn', function(){
            if (confirm('Do you really want to leave?')) {
                location.href = '/logout';
            }
        })
    })
</script>

</body>
</html>
